<!DOCTYPE html>
<html>
  <head>
    <script src="jquery.js"></script>
    <script src="data_generator.js"></script>
  </head>
  <body>
    <script>

      $(document).ready(function(){

        //Initial tweet displaying mechanism.
        var update = function(){
          var $body = $('.tweets');
          $body.html('');

          var index = streams.home.length - 1;
          while(index >= 0){
            var tweet = streams.home[index];

            var $tweet = $('<div></div>');
            var username = $('<p class="username">@' + tweet.user + '</p>');
            var message = $('<p class="message">' + tweet.message + '</p>');
            var timestamp = $('<p class="timestamp">' + tweet.created_at + '</p>');

            $tweet.append(username);
            $tweet.append(message);
            $tweet.append(timestamp);

            $tweet.appendTo($body);
            index -= 1;
          }
          setTimeout(update, updateTime);
        };

        //Default: tweets update every 3 seconds.
        var updateTime = 3000;

        $('.updatenow').on('click', update);

        //Allow user to set auto-update frequency.
        $('.updatetime').on('keyup', function(event){
          if(event.keyCode == 13){
            var ms = Number($(this).val());
            if(ms){
              updateTime = ms * 1000;
              update();
            }else{
              alert("Error: Not a valid number!");
            }
            $(this).blur();
          }
        });

        //Initial display of tweets upon opening page.
        update();

      });

    </script>

    <h1>Twittler by Marco Au</h1>
    <br>
    <input class="input" type="text" value="Enter your tweet here!"></input>
    <button class="enter">Enter</button>
    <br>
    Auto-update every: <input class="updatetime" type="number" value='3'></input>seconds <button class="updatenow">Update now!</button>
    <div class="tweets"></div>

  </body>
</html>
